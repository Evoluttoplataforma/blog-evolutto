---
import { nextLive, isLiveUpcoming, formatLiveDate, formatLiveTime } from '../../data/nextLive';

const showCard = isLiveUpcoming(nextLive);
const formattedDate = formatLiveDate(nextLive.dateISO);
const formattedTime = formatLiveTime(nextLive.dateISO);
---

{showCard ? (
  <div class="next-live-card">
    <div class="live-badge">
      <span class="badge-dot"></span>
      Proxima Live
    </div>

    <div class="live-datetime">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
      </svg>
      <span>{formattedDate}</span>
      <span class="datetime-separator">|</span>
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
      <span>{formattedTime}</span>
    </div>

    <h4 class="live-title">{nextLive.title}</h4>

    <p class="live-description">{nextLive.description}</p>

    <div class="live-platform">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path>
        <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
      </svg>
      <span>{nextLive.platform}</span>
    </div>

    <div class="live-actions">
      <a href={nextLive.href} class="live-cta" target="_blank" rel="noopener noreferrer">
        {nextLive.ctaLabel}
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M5 12h14"></path>
          <path d="M12 5l7 7-7 7"></path>
        </svg>
      </a>
      {nextLive.detailsHref && (
        <a href={nextLive.detailsHref} class="live-details" target="_blank" rel="noopener noreferrer">
          Ver detalhes
        </a>
      )}
    </div>
  </div>
) : (
  <div class="no-live-card">
    <span class="no-live-text">Sem lives agendadas no momento</span>
  </div>
)}

<style>
  .next-live-card {
    padding: 20px;
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border: 1px solid #fbbf24;
    border-radius: 14px;
  }

  .live-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #92400e;
    background: #fff;
    border-radius: 4px;
    margin-bottom: 12px;
  }

  .badge-dot {
    width: 6px;
    height: 6px;
    background: #dc2626;
    border-radius: 50%;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  .live-datetime {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 6px;
    margin-bottom: 10px;
    font-size: 13px;
    color: #92400e;
  }

  .live-datetime svg {
    flex-shrink: 0;
    opacity: 0.8;
  }

  .datetime-separator {
    color: #d97706;
    opacity: 0.5;
  }

  .live-title {
    margin: 0 0 8px;
    font-size: 1rem;
    font-weight: 700;
    color: #78350f;
    line-height: 1.3;
  }

  .live-description {
    margin: 0 0 12px;
    font-size: 0.875rem;
    color: #92400e;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .live-platform {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 16px;
    font-size: 12px;
    color: #b45309;
  }

  .live-platform svg {
    opacity: 0.8;
  }

  .live-actions {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .live-cta {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 12px 20px;
    font-size: 0.875rem;
    font-weight: 600;
    color: #fff;
    background: #b45309;
    border-radius: 8px;
    text-decoration: none;
    transition: all 0.15s ease;
  }

  .live-cta:hover {
    background: #92400e;
    transform: translateY(-1px);
  }

  .live-cta svg {
    transition: transform 0.15s ease;
  }

  .live-cta:hover svg {
    transform: translateX(2px);
  }

  .live-details {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 8px 16px;
    font-size: 13px;
    font-weight: 500;
    color: #92400e;
    background: transparent;
    border: 1px solid #d97706;
    border-radius: 8px;
    text-decoration: none;
    transition: all 0.15s ease;
  }

  .live-details:hover {
    background: rgba(255, 255, 255, 0.5);
  }

  /* No live card */
  .no-live-card {
    padding: 16px;
    background: #f8fafc;
    border: 1px dashed #cbd5e1;
    border-radius: 12px;
    text-align: center;
  }

  .no-live-text {
    font-size: 13px;
    color: #64748b;
  }

  /* Mobile adjustments */
  @media (max-width: 640px) {
    .next-live-card {
      padding: 16px;
    }

    .live-cta {
      padding: 14px 20px;
      font-size: 0.9375rem;
    }

    .live-details {
      padding: 10px 16px;
    }
  }
</style>
